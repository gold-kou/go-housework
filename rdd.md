# 要件定義書(Requirement Definition Document)
## サービス要件
### サービス名
HouseWorkTODO

### サービス概要
各家庭の家事タスクを管理するサービスです。
「誰が、いつ、何をやったか」をデータとして集計し可視化することで、「自分ばかりが家事をやっている」という思い込みをなくし、円満な家庭を築く一つの手段となります。

### サービスロール種類
- 世帯管理者：世帯を作成したユーザです。世帯情報を管理する権限を有します。
- 一般ユーザ：世帯に属するユーザです。

## 機能要件(機能一覧)
### 認証系
#### ユーザ登録
- メールアドレス、ユーザ名、パスワードを入力
- メールアドレス検証は省略
- パスワードはハッシュ化
- RDBに登録
- "The user registration completed."をレスポンス
- 登録済みメールアドレスであればエラーレスポンス
- メールアドレス形式でなければエラーレスポンス
- ユーザ名が指定文字種類かつ10桁でなければエラーレスポンス
- 既に存在しているユーザ名であればエラーレスポンス(ユーザ名は一意) 
- パスワードが指定文字種類かつ6桁~10桁でなければエラーレスポンス

#### 世帯管理者登録
- なし
- 世帯作成時に自動で付与される

#### パスワード変更
- メールアドレスを入力
- 新パスワードを生成
- 新パスワードをRDBに登録
- メールアドレス宛てに新パスワードを記載して送信
- "Your password is reset."をレスポンス

#### ログイン
- メールアドレス、パスワードを入力
- JWTを返却する（有効期限24時間）
- "login success"をレスポンス
- 間違っていれば"The email or password is not correct."をエラーレスポンス

#### ログアウト
- バックエンドでのログアウト機能は有しない
- （フロントエンドがあればローカルストレージを削除するなどの方法）

#### トークン仕様
- claim
	- name
	- iat
未定
	
#### トークン検証
- リクエストヘッダに格納されたJWTを検証する
	- 鍵を使った検証
	- 有効期限確認

### 世帯管理系
#### 世帯作成
- 世帯名を入力
- トークン検証
- 世帯ID(uuid)払い出し
- リクエストユーザを世帯にINSERT
- リクストユーザを世帯管理者としてINSERT
- 世帯ID、世帯名をレスポンス

#### 世帯詳細取得（世帯管理者のみ）
- トークン検証・認可
- 世帯IDでSELECT
- 世帯IDと世帯名と世帯メンバをレスポンス

#### 世帯更新(世帯管理者のみ)
- 世帯名を入力
- トークン検証・認可
- 世帯名をUPDATE
- 世帯IDと世帯名とメンバをレスポンス

#### 世帯削除(世帯管理者のみ)
- トークン検証・認可
- 世帯IDでDELETE
- "Delete complated."をレスポンス
- 存在しない世帯IDであればエラーレスポンス

### 世帯メンバ管理系
#### 世帯メンバ追加（世帯管理者のみ）
- ユーザ名を入力
- トークン検証・認可
- 世帯IDのレコードにユーザ名をUPDATE
- 世帯IDと世帯名とユーザ名をレスポンス
- 既にそのユーザ名がいずれかの世帯に存在している場合はエラーレスポンス

#### 世帯メンバ一覧取得（世帯管理者のみ）
- トークン検証・認可
- 世帯IDでSELECT
- 世帯IDと世帯名と世帯メンバをレスポンス

#### 世帯メンバ削除（世帯管理者のみ）
- ユーザ名を入力
- トークン検証・認可
- 世帯ID、ユーザ名でDELETE
- 世帯IDと世帯名とユーザ名をレスポンス

### 家事タスク管理系
#### TODO家事タスク登録
- 家事タスク名、担当者（ユーザ名）を入力
- トークン検証
- 家事タスクID払い出し
- 世帯ID、家事タスクID、家事タスク名、ステータス（未完了）、担当者をINSERT
- 世帯ID、家事タスクID、家事タスク名、ステータス、担当者をレスポンス
- 重複したタスク名であればエラーレスポンス

#### 家事タスク一覧取得
- トークン検証
- リクエストユーザの世帯の家事タスクをSELECT
	- 日付指定なければ今日の日付
- 全ての世帯ID、家事タスクID、家事タスク名、担当者、ステータスをレスポンス

#### 家事タスク更新
- 家事タスクID、家事タスク名、担当者、ステータス、（完了日付）を入力
- トークン検証・認可
- リクエストパラメータの情報でUPDATE。ステータスが完了であれば完了日付をUPDATE。
	- 日付指定なければ今日の日付
- 世帯ID、家事タスクID、家事タスク名、担当者、ステータスをレスポンス
- 存在しない家事タスクIDであればエラーレスポンス
- 存在しない担当者であればエラーレスポンス
- ステータスが未完了か完了でなければエラーレスポンス

#### 家事タスク削除(家事タスク登録者のみ)
- 家事タスクIDを入力
- トークン検証・認可
- 家事タスクIDでDELETE
- "Delete complete"をレスポンス
- 存在しない家事タスクIDであればエラーレスポンス
- 家事タスクを作成したユーザでなければエラーレスポンス

### メモ管理系
comming soon...
#### メモ作成
#### メモ取得
#### メモ更新
#### メモ削除

## システム構成
フロントエンドまだ
ネイティブアプリまだ
スマートスピーカまだ
Cfnまだ


